geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.26), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.27), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.28), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.29), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.30), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.31), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.32), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.33), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.34), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.35), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.36), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.37), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.38), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.39), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.30), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.41), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.42), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.43), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.44), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.45), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.46), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.47), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.48), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.49), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.40), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.51), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.52), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.53), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.54), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.55), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.56), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.57), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.58), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.59), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.50), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.61), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.62), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.63), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.64), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.65), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.66), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.67), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.68), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.69), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.60), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.71), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.72), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.73), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.74), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.75), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.76), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.77), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.78), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.79), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.70), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.81), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.82), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.83), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.84), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.85), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.86), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.87), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.88), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.89), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.80), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.91), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.92), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.93), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.94), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.95), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.96), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.97), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.98), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.99), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.100), color = "gray70", size = 1.0, alpha = 1) +
geom_line(models, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=genomic, colour = "Deterministic SIR"), size = 1.0) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=median, colour = "Stochastic SIR (median)"), size = 1.0) +
geom_line(models, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=reported, colour = "Deterministic SIR (using reported data)"), size = 1.0) +
geom_col(reported, mapping = aes(x=as.Date(date, format="%d-%b-%y") , y=reported*mult, fill = "Reported data")) +
theme_classic() +
labs(x="Date", y="Number of Projected Cases") +
scale_x_date(date_breaks = "3 month",
labels=date_format("%b-%Y")) +
scale_colour_manual(" ",
values = c("Deterministic SIR" = "dark blue",
"Stochastic SIR (median)" = "dark green",
"Stochastic SIR" = "gray70",
"Deterministic SIR (using reported data)" = "dark red"))  +
scale_fill_manual("",values=alpha("orange",0.5)) +
theme(legend.position = "top") +
geom_vline(xintercept = as.Date("9/2/20", format="%m/%d/%y"), linetype = 4, color="black") +
theme(text = element_text(size=15),
axis.title.y.left = element_text(margin = margin(t = 0, r = 15, b = 0, l = 0)),
axis.title.y.right = element_text(margin = margin(t = 0, r = 0, b = 0, l = 15)),
axis.title.x = element_text(margin = margin(t = 15, r = 0, b = 0, l = 0)),
legend.key=element_blank(),
axis.ticks.y.right = element_line(color = "orange"),
axis.line.y.right = element_line(color = "orange"),
axis.text.y.right = element_text(colour = "orange")) +
scale_y_continuous(label = comma,
sec.axis=sec_axis(~.*1/mult,name="Number of Reported Cases")) +
annotate("rect", xmin = as.Date("7/27/20", format="%m/%d/%y"), xmax = as.Date("4/31/21", format="%m/%d/%y"),
ymin = 0, ymax = 700000,
alpha = .2) +
annotate("text", x = as.Date("2/31/21", format="%m/%d/%y"), y = 560000, label = "Projection")
p
p <- ggplot() +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.1, colour = "Stochastic SIR",), size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.2), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.3), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.4), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.5), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.6), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.7), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.8), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.9), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.10), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.11), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.12), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.13), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.14), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.15), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.16), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.17), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.18), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.19), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.20), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.21), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.22), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.23), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.24), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.25), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.26), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.27), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.28), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.29), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.30), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.31), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.32), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.33), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.34), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.35), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.36), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.37), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.38), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.39), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.30), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.41), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.42), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.43), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.44), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.45), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.46), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.47), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.48), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.49), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.40), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.51), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.52), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.53), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.54), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.55), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.56), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.57), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.58), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.59), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.50), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.61), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.62), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.63), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.64), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.65), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.66), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.67), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.68), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.69), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.60), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.71), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.72), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.73), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.74), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.75), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.76), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.77), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.78), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.79), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.70), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.81), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.82), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.83), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.84), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.85), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.86), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.87), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.88), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.89), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.80), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.91), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.92), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.93), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.94), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.95), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.96), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.97), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.98), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.99), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.100), color = "gray70", size = 1.0, alpha = 1) +
geom_line(models, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=genomic, colour = "Deterministic SIR"), size = 1.0) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=median, colour = "Stochastic SIR (median)"), size = 1.0) +
geom_line(models, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=reported, colour = "Deterministic SIR (using reported data)"), size = 1.0) +
geom_col(reported, mapping = aes(x=as.Date(date, format="%d-%b-%y") , y=reported*mult, fill = "Reported data")) +
theme_classic() +
labs(x="Date", y="Number of Projected Cases") +
scale_x_date(date_breaks = "3 month",
labels=date_format("%b-%Y")) +
scale_colour_manual(" ",
values = c("Deterministic SIR" = "dark blue",
"Stochastic SIR (median)" = "dark green",
"Stochastic SIR" = "gray70",
"Deterministic SIR (using reported data)" = "dark red"))  +
scale_fill_manual("",values=alpha("orange",0.5)) +
theme(legend.position = "top") +
geom_vline(xintercept = as.Date("9/2/20", format="%m/%d/%y"), linetype = 4, color="black") +
theme(text = element_text(size=15),
axis.title.y.left = element_text(margin = margin(t = 0, r = 15, b = 0, l = 0)),
axis.title.y.right = element_text(margin = margin(t = 0, r = 0, b = 0, l = 15)),
axis.title.x = element_text(margin = margin(t = 15, r = 0, b = 0, l = 0)),
legend.key=element_blank(),
axis.ticks.y.right = element_line(color = "orange"),
axis.line.y.right = element_line(color = "orange"),
axis.text.y.right = element_text(colour = "orange")) +
scale_y_continuous(label = comma,
sec.axis=sec_axis(~.*1/mult,name="Number of Reported Cases")) +
annotate("rect", xmin = as.Date("7/27/20", format="%m/%d/%y"), xmax = as.Date("4/30/21", format="%m/%d/%y"),
ymin = 0, ymax = 700000,
alpha = .2) +
annotate("text", x = as.Date("2/31/21", format="%m/%d/%y"), y = 560000, label = "Projection")
p
p <- ggplot() +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.1, colour = "Stochastic SIR",), size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.2), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.3), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.4), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.5), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.6), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.7), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.8), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.9), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.10), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.11), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.12), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.13), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.14), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.15), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.16), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.17), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.18), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.19), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.20), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.21), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.22), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.23), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.24), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.25), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.26), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.27), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.28), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.29), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.30), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.31), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.32), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.33), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.34), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.35), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.36), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.37), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.38), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.39), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.30), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.41), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.42), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.43), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.44), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.45), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.46), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.47), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.48), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.49), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.40), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.51), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.52), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.53), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.54), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.55), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.56), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.57), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.58), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.59), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.50), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.61), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.62), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.63), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.64), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.65), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.66), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.67), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.68), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.69), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.60), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.71), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.72), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.73), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.74), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.75), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.76), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.77), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.78), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.79), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.70), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.81), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.82), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.83), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.84), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.85), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.86), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.87), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.88), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.89), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.80), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.91), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.92), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.93), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.94), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.95), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.96), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.97), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.98), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.99), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.100), color = "gray70", size = 1.0, alpha = 1) +
geom_line(models, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=genomic, colour = "Deterministic SIR"), size = 1.0) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=median, colour = "Stochastic SIR (median)"), size = 1.0) +
geom_line(models, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=reported, colour = "Deterministic SIR (using reported data)"), size = 1.0) +
geom_col(reported, mapping = aes(x=as.Date(date, format="%d-%b-%y") , y=reported*mult, fill = "Reported data")) +
theme_classic() +
labs(x="Date", y="Number of Projected Cases") +
scale_x_date(date_breaks = "3 month",
labels=date_format("%b-%Y"),
limits = as.Date(c('2020-03-01','2021-04-30'))) +
scale_colour_manual(" ",
values = c("Deterministic SIR" = "dark blue",
"Stochastic SIR (median)" = "dark green",
"Stochastic SIR" = "gray70",
"Deterministic SIR (using reported data)" = "dark red"))  +
scale_fill_manual("",values=alpha("orange",0.5)) +
theme(legend.position = "top") +
geom_vline(xintercept = as.Date("9/2/20", format="%m/%d/%y"), linetype = 4, color="black") +
theme(text = element_text(size=15),
axis.title.y.left = element_text(margin = margin(t = 0, r = 15, b = 0, l = 0)),
axis.title.y.right = element_text(margin = margin(t = 0, r = 0, b = 0, l = 15)),
axis.title.x = element_text(margin = margin(t = 15, r = 0, b = 0, l = 0)),
legend.key=element_blank(),
axis.ticks.y.right = element_line(color = "orange"),
axis.line.y.right = element_line(color = "orange"),
axis.text.y.right = element_text(colour = "orange")) +
scale_y_continuous(label = comma,
sec.axis=sec_axis(~.*1/mult,name="Number of Reported Cases")) +
annotate("rect", xmin = as.Date("7/27/20", format="%m/%d/%y"), xmax = as.Date("4/30/21", format="%m/%d/%y"),
ymin = 0, ymax = 700000,
alpha = .2) +
annotate("text", x = as.Date("2/31/21", format="%m/%d/%y"), y = 560000, label = "Projection")
p
View(reported)
p <- ggplot() +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.1, colour = "Stochastic SIR",), size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.2), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.3), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.4), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.5), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.6), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.7), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.8), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.9), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.10), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.11), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.12), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.13), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.14), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.15), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.16), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.17), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.18), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.19), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.20), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.21), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.22), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.23), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.24), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.25), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.26), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.27), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.28), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.29), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.30), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.31), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.32), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.33), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.34), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.35), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.36), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.37), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.38), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.39), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.30), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.41), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.42), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.43), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.44), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.45), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.46), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.47), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.48), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.49), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.40), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.51), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.52), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.53), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.54), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.55), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.56), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.57), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.58), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.59), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.50), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.61), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.62), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.63), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.64), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.65), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.66), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.67), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.68), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.69), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.60), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.71), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.72), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.73), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.74), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.75), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.76), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.77), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.78), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.79), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.70), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.81), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.82), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.83), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.84), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.85), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.86), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.87), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.88), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.89), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.80), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.91), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.92), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.93), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.94), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.95), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.96), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.97), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.98), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.99), color = "gray70", size = 1.0, alpha = 1) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=Y.100), color = "gray70", size = 1.0, alpha = 1) +
geom_line(models, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=genomic, colour = "Deterministic SIR"), size = 1.0) +
geom_line(sde, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=median, colour = "Stochastic SIR (median)"), size = 1.0) +
geom_line(models, mapping = aes(x=as.Date(date,format="%m/%d/%y"), y=reported, colour = "Deterministic SIR (using reported data)"), size = 1.0) +
geom_col(reported, mapping = aes(x=as.Date(date, format="%d-%b-%y") , y=reported*mult, fill = "Reported data")) +
theme_classic() +
labs(x="Date", y="Number of Projected Cases") +
scale_x_date(date_breaks = "3 month",
labels=date_format("%b-%Y"),
limits = as.Date(c('2020-03-01','2021-03-31'))) +
scale_colour_manual(" ",
values = c("Deterministic SIR" = "dark blue",
"Stochastic SIR (median)" = "dark green",
"Stochastic SIR" = "gray70",
"Deterministic SIR (using reported data)" = "dark red"))  +
scale_fill_manual("",values=alpha("orange",0.5)) +
theme(legend.position = "top") +
geom_vline(xintercept = as.Date("9/2/20", format="%m/%d/%y"), linetype = 4, color="black") +
theme(text = element_text(size=15),
axis.title.y.left = element_text(margin = margin(t = 0, r = 15, b = 0, l = 0)),
axis.title.y.right = element_text(margin = margin(t = 0, r = 0, b = 0, l = 15)),
axis.title.x = element_text(margin = margin(t = 15, r = 0, b = 0, l = 0)),
legend.key=element_blank(),
axis.ticks.y.right = element_line(color = "orange"),
axis.line.y.right = element_line(color = "orange"),
axis.text.y.right = element_text(colour = "orange")) +
scale_y_continuous(label = comma,
sec.axis=sec_axis(~.*1/mult,name="Number of Reported Cases")) +
annotate("rect", xmin = as.Date("7/27/20", format="%m/%d/%y"), xmax = as.Date("3/31/21", format="%m/%d/%y"),
ymin = 0, ymax = 700000,
alpha = .2) +
annotate("text", x = as.Date("2/31/21", format="%m/%d/%y"), y = 560000, label = "Projection")
p
# Save plot
ggsave(plot = p,
filename = "ncr-bdsir-projection.png",
width = 9, height = 5, units = "in", dpi = 300)
ggsave(plot = p,
filename = "ncr-bdsir-projection.png",
width = 12, height = 5, units = "in", dpi = 300)
